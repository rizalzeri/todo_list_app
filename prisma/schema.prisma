generator client {
  provider        = "prisma-client-js"
  output          = "../src/generated/prisma"
  previewFeatures = ["multiSchema"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  schemas  = ["master_data", "raw_data"]
}

model Todo {
  id              Int          @id @default(autoincrement())
  title           String       @db.VarChar(255)
  description     String?      @db.Text
  due_date        DateTime     @db.Timestamp
  start_time      DateTime     @db.Timestamp
  end_time        DateTime     @db.Timestamp
  status_id       Int
  category_id     Int
  position        Int          @default(0)

  created_at      DateTime     @default(now()) @db.Timestamp
  updated_at      DateTime?    @db.Timestamp // ❗ Boleh null sekarang, dan tidak otomatis di-update

  category        Category     @relation(fields: [category_id], references: [id], onDelete: Cascade)
  status          Status       @relation(fields: [status_id], references: [id], onDelete: Restrict)

  @@map("todos")
  @@schema("raw_data")
}
enum ImportStatus {
  pending
  success
  failed

  @@schema("raw_data")
}

model Category {
  id         Int      @id @default(autoincrement())
  name       String   @db.VarChar(50)
  created_at DateTime @default(now()) @db.Timestamp
  updated_at DateTime?  @db.Timestamp // ❗ Boleh null juga

  todos      Todo[]

  @@map("categories")
  @@schema("master_data")
}

model Status {
  id          Int     @id @default(autoincrement())
  status_name String  @db.VarChar(100)
  todos       Todo[]

  @@map("statuses")
  @@schema("master_data")
}